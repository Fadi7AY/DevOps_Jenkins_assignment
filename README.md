# üöÄ Jenkins_SAP 

## üìÇ Repository  
**Repo URL:** üëâ [https://github.com/Fadi7AY/DevOps_Jenkins_assignment](https://github.com/Fadi7AY/DevOps_Jenkins_assignment)

Clone locally:
```bash
git clone https://github.com/Fadi7AY/DevOps_Jenkins_assignment.git
cd DevOps_Jenkins_assignment
```

---
**Pipeline summary:** checks out from Git, runs `scripts/hello.sh "$NAME"` to create `output.txt`, prints it
and archives it as an artifact (with fingerprint).


**SCM polling:** `H/2 * * * *` (checks ~every 2 min for changes , if it spots any , the pipeline executes).

---

## ‚öôÔ∏è Jenkins Controller + Agent (Docker Setup)

### üèóÔ∏è Step 1: Create Persistent Volumes
```bash
docker volume create jenkins_home
docker volume create agent1_workdir
```

### üåê Step 2: Create a Private Docker Network
```bash
docker network create jenkins-net
```

### üì¶ Step 3: Run the Jenkins Controller (LTS)
```bash
docker run -d --name jenkins \
  --network jenkins-net \
  -p 8080:8080 \
  -v jenkins_home:/var/jenkins_home \
  jenkins/jenkins:lts
```

üîó Access Jenkins UI: [http://localhost:8080](http://localhost:8080)  
üîë Get initial admin password:
```bash
docker logs jenkins 2>&1 | grep -A2 "Please use the following password"
```

### üñ•Ô∏è Step 4: Configure Agent Node in Jenkins UI
1. Go to **Manage Jenkins ‚Üí Nodes ‚Üí New Node**  
2. Node type: **Permanent Agent**  
3. Remote root directory: `/home/jenkins/agent`  
4. Launch method: **Launch agent by connecting it to the controller (inbound)**  
5. Save ‚Üí copy the **Node Secret**

### ü§ñ Step 5: Run the Inbound Agent Container
```bash
docker run -d --name jenkins-agent-1 \
  --restart unless-stopped \
  --network jenkins-net \
  -e JENKINS_URL="http://jenkins:8080" \
  -e JENKINS_AGENT_NAME="linux-docker-1" \
  -e JENKINS_SECRET="PASTE_NODE_SECRET_HERE" \
  -e JENKINS_AGENT_WORKDIR="/home/jenkins/agent" \
  -v agent1_workdir:/home/jenkins/agent \
  jenkins/inbound-agent:latest
```
---
üîë Credentials Handling

**If repo is public, you can add ‚ÄúNo credentials required**

No secrets are hardcoded in the repository or Jenkinsfile.

If the GitHub repo were private, credentials would be added in Manage Jenkins ‚Üí Credentials:

HTTPS: Username + Personal Access Token

SSH: SSH private key

In jobs, these credentials are referenced by their ID, never exposed in source control or console logs.

The agent secret used to connect linux-docker-1 is generated by Jenkins automatically and passed as an environment variable to the agent container. It is not committed to the repo.

---
Q1. If you kill the Jenkins container, what command do you use to start it again with the same configuration?

A: if the container was stopped I use this command : 
```bash 
docker start jenkins
```
so it starts with the same data.

and if the container is removed , this command is used :

```bash
docker run -d --name jenkins \
  -p 8080:8080 \
  -v jenkins_home:/var/jenkins_home \
  jenkins/jenkins:lts

```
by this , the container will take the data that was saved by the previous container on my local volume (jenkins_home)

---

Q2. Why does Jenkins preserve its state after restart?

A: Because Jenkins stores all its configuration, jobs, plugins, and history in /var/jenkins_home. In Docker, this path is mapped to the named volume 

jenkins_home, which persists independently of the container (the jenkins_home is local on my pc , so the data is always accessible by other containers , 

even if a new one was created , it just must be connected to the volume).

---

üèÜ Bonus Section ‚Äì Dedicated Linux Agent
üîß What I Did

Created a new node in Jenkins UI:

Name: linux-docker-1

Remote root directory: /home/jenkins/agent

Label: linux-docker-extra

Launch method: Inbound agent with secret

Created a Docker network so the agent and controller can talk:
```bash
docker network create jenkins-net
docker network connect jenkins-net jenkins
```

Started the agent container with the official inbound agent image:
```bash
docker run -d --name jenkins-agent-1 \
  --restart unless-stopped \
  --network jenkins-net \
  -e JENKINS_URL="http://jenkins:8080" \
  -e JENKINS_AGENT_NAME="linux-docker-1" \
  -e JENKINS_SECRET="<SECRET_FROM_NODE_PAGE>" \
  -e JENKINS_AGENT_WORKDIR="/home/jenkins/agent" \
  -v agent1_workdir:/home/jenkins/agent \
  jenkins/inbound-agent:latest
```

Modified the Jenkinsfile to target the agent by label:
```bash
agent { label 'linux-docker-extra' }
```

Ran the pipeline ‚Äî it executed on the agent and archived output.txt.

---

## üì∏ Screenshots

-  Jenkins Build History with successful runs  
  ![Build History](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/Artifact%20+%20successful%20builds.PNG?raw=true)

-  Archived artifact (`output.txt`) in Jenkins  
  ![Artifact](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/archived%20artifact.PNG?raw=true)

-  Console output showing content of `output.txt`  
  ![Output](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/artifact.PNG?raw=true)

-  Artifact fingerprint recorded  
  ![Fingerprint](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/fingerprint.PNG?raw=true)

-  Pipeline triggered by SCM change and executed on agent  
  ![Run on Agent](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/Run%20on%20agent%20+%20trigger%20by%20SCM%20Change.PNG?raw=true)

-  Running node visible in Jenkins  
  ![Running Node](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/running%20node.PNG?raw=true)

-  Example of pipeline before adding the agent (ran on built-in node)  
  ![Built-in Node](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/started%20by%20User%20before%20adding%20agent.PNG?raw=true)

-  Docker ps showing both controller and agent containers  
  ![Docker PS](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/docker%20ps.PNG?raw=true)

-  Kill/restart test of Jenkins container confirming persistence  
  ![Restart](https://github.com/Fadi7AY/DevOps_Jenkins_assignment/blob/main/Screenshots/tried%20to%20kill%20the%20container.PNG?raw=true)
